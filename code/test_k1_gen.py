import gc, ngu  # auto-gen
my_pubkey = b'\x04' + b'\x82\xfbw\x91\xe1\xbbk|\x99Q\xd1\xfb\x90\x9b\xe4\x11\x9e\x80q\xdd&G\x16\xa0D\x130\x8asf!\x88\x9dG>\xbb\xc9:\xb5:#\r\x8e\xf4\x02\x16\x03\x91\x8d\xebbPf\x97\x90\x9f<\xc4L\x0bJ\x1c=\xe2'
x = ngu.secp256k1.keypair(b'12121212121212121212121212121212')
assert x.pubkey().to_bytes() == b'\x02n\xc8\xb0z\x80\x80\xeb\x06\x9d\xf1\xdd\xbdw\xb9\x0eH\x8e\xf3y}\x87\x14\t!\xefA\xc6\xd8~\x1aB\x17'


assert x.ecdh_multiply(my_pubkey) == b"m\x9b*a\xfaXg\x95\xe3\x8d.\xe8\xbb\xc3\xd6o\xb5oa\x9e\xd9\xb0\xb5\xf1.v\xad\x9d\x98'\xe0|"


x = ngu.secp256k1.keypair(b'\x0f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff')
assert x.pubkey().to_bytes() == b'\x036\x07KP\xb9\xc9\xd5Na;\thGB\x0bHnL\x8f\xf6\xc7\xb4\xe6{\x12\xf5b\xda%aUi'


assert x.ecdh_multiply(my_pubkey) == b')\x86L\x9c[\x95\xe8\t\xb5\xe5\x19\xa8\xeb\xf7\xae\xeb\xe1\xc4P\x8d\x1eJG\xe1\xec\xef\xa4\xf6\x9c\x1d\x8a\x9a'


x = ngu.secp256k1.keypair(b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01')
assert x.pubkey().to_bytes() == b'\x02y\xbef~\xf9\xdc\xbb\xacU\xa0b\x95\xce\x87\x0b\x07\x02\x9b\xfc\xdb-\xce(\xd9Y\xf2\x81[\x16\xf8\x17\x98'


assert x.ecdh_multiply(my_pubkey) == b'\xd8,\xb5N\xdd\xb7 \xb3\xb9`\xa7\x8d\x8dV\x189S9\xb8/\xb7\xf9J\xe5\x1a\xa1\xe7\x8fvU\tI'


print('PASS')
